#include "mbnrg_2b_A1B2Z2_A1B2Z2_deg4_v1.h"

////////////////////////////////////////////////////////////////////////////////

namespace mbnrg_A1B2Z2_A1B2Z2_deg4 {

mbnrg_A1B2Z2_A1B2Z2_deg4_v1::mbnrg_A1B2Z2_A1B2Z2_deg4_v1(const std::string mon1, const std::string mon2) {

    // =====>> BEGIN SECTION CONSTRUCTOR <<=====
    // =>> PASTE RIGHT BELOW THIS LINE <==


    if ( mon1.size() >= 6 && mon1.substr(0, 6) == "h2o_2a"
         and mon1 == mon2 ) {
        coefficients = std::vector<double> {
             3.743644465906523e+01, // 0
            -1.780388406575438e+01, // 1
             2.549676295590911e+01, // 2
             1.529814436622769e+02, // 3
            -5.292375195290064e+01, // 4
            -7.294565617295241e+00, // 5
             5.832255036264905e+00, // 6
            -7.718422107901714e+01, // 7
            -3.407792422483329e-04, // 8
            -1.594764979973423e+02, // 9
             1.168960772593294e+01, // 10
            -8.186530143520496e+00, // 11
             2.646195394401774e+01, // 12
            -7.705885671378758e+01, // 13
             1.977060460006997e+00, // 14
            -1.578412760514575e+01, // 15
             5.640874332257756e+01, // 16
             9.819918811411682e+01, // 17
             3.615032335924462e-01, // 18
            -7.087273581335495e+01, // 19
            -2.327565803495043e-03, // 20
             1.900921662597371e+01, // 21
            -3.072872432282117e+00, // 22
             1.280212221631542e+00, // 23
             1.681890343577074e+01, // 24
            -4.015970360319049e+01, // 25
             6.763197825228951e+01, // 26
            -1.877955434669097e+02, // 27
            -1.249214029119870e+02, // 28
            -5.311693842982105e+01, // 29
            -9.864359492038083e+01, // 30
            -2.048592795088054e-01, // 31
            -1.309203444001685e+01, // 32
             2.365128486870024e+01, // 33
             3.661066824615975e+01, // 34
            -1.108598535080414e+01, // 35
             3.012085831067933e-01, // 36
            -1.113544125009533e+02, // 37
             1.162893270297513e+02, // 38
             6.904801642652953e+01, // 39
            -1.717921093814430e+01, // 40
             8.068924325981026e-02, // 41
            -9.082506673621334e+01, // 42
             1.424382189912448e-01, // 43
             3.484256965420802e+01, // 44
            -5.430893574515849e+00, // 45
             4.081071277585801e+01, // 46
             8.152008499257849e+01, // 47
             1.152198794700300e+02, // 48
             4.677054768651907e+01, // 49
            -3.227121405378299e-01, // 50
             6.505231668687856e+01, // 51
            -2.104282102422926e+02, // 52
            -1.911269980859581e+01, // 53
            -6.888418501408952e+01, // 54
            -1.911085147149863e+02, // 55
            -3.949125642350074e-03, // 56
             1.524568897309847e+01, // 57
             2.380433544829224e+02, // 58
             1.104932741299759e+01, // 59
             1.665902335556754e-02, // 60
             1.175954009566766e+01, // 61
             2.882673306673524e+02, // 62
             2.086361397644346e+02, // 63
             2.625955961204664e+01, // 64
             3.786064447515396e+01, // 65
             8.690434800472927e+01, // 66
            -1.634532267414168e+01, // 67
            -3.903078928220544e+01, // 68
            -4.410142763256602e+01, // 69
             6.498362276477501e+00, // 70
             4.030889588078256e-02, // 71
            -1.578270602764035e+02, // 72
            -4.099225329968833e+01, // 73
            -1.216903091785238e+02, // 74
             2.111571546964749e+00, // 75
             5.763365908175338e-05, // 76
            -1.211712900832263e+02, // 77
             1.744079814612814e+01, // 78
             1.977664931313792e-02, // 79
            -9.727536890970039e-01, // 80
             4.407501034332859e+01, // 81
            -2.432208133792273e-03, // 82
             4.584566413023681e+01, // 83
            -8.626367090954213e+00, // 84
            -1.264602603485650e-01, // 85
            -5.705886075369069e+01, // 86
             7.424732028094572e-01, // 87
             7.092951411861407e+01, // 88
             3.966823286211680e+01, // 89
            -1.131891718444215e+01, // 90
             3.464448096235755e-01, // 91
             5.434368306438290e-02, // 92
             2.918845548935021e+01, // 93
             6.859393687649708e+01, // 94
             1.445729287175194e-01, // 95
             3.927687894161813e+00, // 96
             8.878535701688275e+00, // 97
             1.711302592101876e-04, // 98
             9.543988138226997e+01, // 99
             4.685739860569350e-03, // 100
             1.250476323517516e+01, // 101
             1.585832380967840e-01, // 102
            -7.571442789860382e-02, // 103
             7.577679918552850e+01, // 104
            -5.736643580892564e+00, // 105
             1.688575749112669e+02, // 106
            -8.788438568769909e+00, // 107
            -1.727506335419414e+01, // 108
             7.270926624446595e+01, // 109
             1.777317152005565e+02, // 110
            -2.881079770940693e+01, // 111
            -9.785344178732569e+01, // 112
             5.759423402101257e-01, // 113
            -1.077544785684490e-01, // 114
            -8.629646900810334e-01, // 115
             1.765894053774784e+01, // 116
            -1.668162808260070e-01, // 117
             4.945292265775492e-01, // 118
             2.364727875014300e-04, // 119
            -2.637800183184282e-01, // 120
             1.307218225864815e+01, // 121
            -2.431662739971815e-01, // 122
            -3.088863682043027e+00, // 123
            -9.528095004618386e+00, // 124
             3.965169140371281e+01, // 125
             3.046901859124845e+01, // 126
            -6.751542302416375e+01, // 127
             1.877907125673273e+00, // 128
            -1.136826454656094e+02, // 129
             4.506952227744454e-09, // 130
            -1.605260816640864e+01, // 131
            -4.158342092740398e+01, // 132
            -6.612917846093849e+01, // 133
            -6.455297693711584e-01, // 134
             5.617543379306655e+01, // 135
            -4.913582618011954e+01, // 136
             2.404936235436363e+00, // 137
            -2.665496159540575e-03, // 138
            -9.258620202330897e+01, // 139
            -7.943480120544137e-02, // 140
            -2.069094740969478e-01, // 141
            -1.491819441090948e+01, // 142
             5.958304622840993e+01, // 143
            -2.920106027465856e+02, // 144
             1.193605761665999e+00, // 145
             4.228593672341376e+02, // 146
            -3.784047117787260e+00, // 147
             1.140005241294883e+00, // 148
            -6.725311401723850e+01, // 149
            -7.142920650631029e-02, // 150
            -2.438043859559327e+00, // 151
             2.902796398574415e+01, // 152
             6.249854820591657e-01, // 153
             3.705397710235901e-01, // 154
            -5.250627542886941e-01, // 155
             1.578044606851933e+01, // 156
             5.710324370545364e-11, // 157
            -1.380458548387885e+02, // 158
            -1.940203662378430e+01, // 159
            -1.797701676707997e+02, // 160
            -7.073998367011436e-03, // 161
            -2.208306703132598e+00, // 162
            -1.599195371519840e+02, // 163
             5.460082155475386e-03, // 164
            -6.314976056214522e-01, // 165
             6.162956483920341e+01, // 166
             5.775009903589396e-03, // 167
            -5.346923526393585e-03, // 168
             5.845395862232363e-09, // 169
             5.044761519549316e-08, // 170
             3.445709552762568e+00, // 171
             1.278520481408472e-04, // 172
             7.417680602321636e+01, // 173
             1.574611247350486e+01, // 174
             4.392233563730498e+01, // 175
             9.935249559153991e-03, // 176
             4.306050805792039e-06, // 177
             4.245230375331917e+00, // 178
            -2.216034760634011e-02, // 179
             1.087095285606459e+00, // 180
             7.440499928283749e+01, // 181
             1.716734574501554e+02, // 182
            -1.579125609208028e+02, // 183
             7.888238865724606e+00, // 184
            -9.211418714414852e+01, // 185
            -4.020160118231683e-01, // 186
             1.386633105496856e-04, // 187
            -3.126954793764857e+02, // 188
             5.109910002304423e-04, // 189
             5.692621225078162e+01, // 190
             1.447658052914515e+02, // 191
            -3.371923719287109e-03, // 192
             1.269158912492873e-01, // 193
             1.249301890190896e+02, // 194
            -1.164747481611608e+00, // 195
             1.930492553715776e+02, // 196
            -4.021616876632342e-01, // 197
             2.046008735453366e+02, // 198
            -3.318386454756435e+01, // 199
            -3.004993503937857e+01, // 200
             6.942954372147054e-09, // 201
             7.150267902964468e+01, // 202
             2.600431079650716e+00, // 203
             1.999066222535960e-04, // 204
             7.585619062357683e-03, // 205
            -1.294593776974632e-04, // 206
            -5.898440849943024e+00, // 207
             1.370424762800171e+02, // 208
             2.334814503330122e-04, // 209
             4.968088592624722e-02, // 210
            -1.712309256541459e+02, // 211
            -1.754878969033832e-03, // 212
            -8.568450247415572e-02, // 213
            -1.117757630200324e-01, // 214
             1.294117842208341e+01, // 215
             3.224372873552473e+01, // 216
             8.055068918496458e+01, // 217
            -1.281785104577934e+02, // 218
             3.851581155554778e+00, // 219
            -7.286444758281756e-07, // 220
             7.429238431519014e+00, // 221
             3.895796045852634e+01, // 222
            -7.248900600816227e-01, // 223
             1.073907239123526e-01, // 224
            -1.219343773562711e+02, // 225
            -5.528646443626646e-03, // 226
            -2.372808616998768e+01, // 227
             2.854159256478805e-02, // 228
            -1.985237872849912e+01, // 229
            -5.136702946864616e-01, // 230
            -2.528390639309645e-06, // 231
            -2.481637637838840e+02, // 232
             1.075221042603844e+00, // 233
            -2.378218963759126e-05, // 234
             1.644391538163165e+02, // 235
             9.947075219043114e+01, // 236
            -5.515236805198139e-03, // 237
             5.407910345596328e-07, // 238
            -5.853089222136767e+00, // 239
            -9.552402986953280e-02, // 240
             2.174339322433583e+01, // 241
            -4.709352512649153e+01, // 242
            -1.131747146152192e+02, // 243
             7.557958541642955e+00, // 244
             1.174732733804824e+02, // 245
             4.532777352197998e+01, // 246
             8.341742777766582e+01, // 247
            -1.071380572932297e+02, // 248
            -7.276900431056542e+00, // 249
            -3.616025263133430e-04, // 250
             3.450500849870378e-02, // 251
            -3.060245491217561e+01, // 252
            -1.157923990447118e-01, // 253
            -2.328042519753854e-06, // 254
             7.259479618050167e+01, // 255
             1.152949635765251e+02, // 256
             9.000775356911331e-02, // 257
            -1.567935817946284e+02, // 258
            -1.068423845886970e+02, // 259
             3.778869363574460e+02, // 260
             1.239636844315413e-01, // 261
            -1.654741490217233e+01, // 262
            -4.842914653214213e+00, // 263
             1.431023268726757e+02, // 264
             1.947909010182252e-02, // 265
            -1.006999548635653e+02, // 266
             2.558532630208722e+01, // 267
             1.763391422337929e+02, // 268
            -1.095552212635275e+02, // 269
            -2.426249046428875e+01, // 270
            -5.694339674604057e-02, // 271
            -1.624297494635424e-01, // 272
            -7.967927695398486e-06, // 273
             4.005339018665870e+01, // 274
            -2.839481662914433e+01, // 275
             9.269359465174864e+01, // 276
             1.488887827633573e+02, // 277
            -2.413800315743326e-05, // 278
             2.182449342170534e+02, // 279
            -1.884113284684162e-01, // 280
            -4.342668955263067e-01, // 281
             9.616565355249936e-02, // 282
             1.493703651675840e+02, // 283
            -1.228192551301251e+02, // 284
            -3.772347983865974e+00, // 285
             1.104925834706243e+01, // 286
            -2.413026190345003e+01, // 287
            -1.376704813992903e+01, // 288
            -8.261342390187639e+00, // 289
             1.496685261103390e+02, // 290
            -1.987179915333337e-02, // 291
            -3.568909758924115e+00, // 292
             3.627089384503671e+00, // 293
            -1.880216492727677e+01, // 294
            -9.228604180501558e+00, // 295
             1.246958506040451e+00, // 296
             3.723712833371209e-01, // 297
            -1.173712600308257e+02, // 298
            -2.770783716230689e-02, // 299
            -4.575436209989543e+01, // 300
             1.717634713027466e+00, // 301
            -1.537211502802355e+02, // 302
            -1.007576736311799e-01, // 303
            -5.290684979885943e+01, // 304
             7.606627727525056e+00, // 305
            -4.107457122405960e+01, // 306
            -1.633097301793633e-01, // 307
             4.059707212388622e-03, // 308
            -2.324570100160502e-06, // 309
             1.242160330648212e+00, // 310
            -2.085129775632513e-01, // 311
             1.608904203466770e+01, // 312
            -2.260403389239860e+01, // 313
            -2.858734888966713e+01, // 314
             2.981348004477206e+02, // 315
            -9.154057997940596e+01, // 316
             8.903700865721972e+01, // 317
             1.562043008194345e+02, // 318
             1.068009959207354e+02, // 319
            -5.476801068581772e-04, // 320
             2.925333038754237e+01, // 321
             3.260774161800693e+01, // 322
             3.336276102191718e-06, // 323
            -5.548443701619472e+00, // 324
            -3.774091053454088e-06, // 325
            -2.840210132020913e+01, // 326
            -9.256846755887092e+01, // 327
            -9.362028723891019e+01, // 328
            -2.730145469089086e+01, // 329
            -2.416338659669792e-07, // 330
             1.638011777245182e+02, // 331
             1.520731594325928e+02, // 332
             4.458559670243679e+00, // 333
             3.570932836921960e+01, // 334
             2.529852253432854e+01, // 335
             1.051154933596189e+02, // 336
             2.325538452006899e+00, // 337
            -3.069392157407755e+01, // 338
            -8.517087417129512e+02, // 339
            -3.279194388515928e-04, // 340
             3.750484458613156e+00, // 341
             3.831106434170032e-05, // 342
             2.793649672051460e+02, // 343
            -6.777436081015389e+01, // 344
             1.626367140400070e+01, // 345
            -5.824854293019459e-04, // 346
             6.535342450161548e+01, // 347
             8.343978797460142e+00, // 348
             2.326948878154900e+01, // 349
            -6.248009084735426e+00, // 350
            -1.258557487632574e-06, // 351
             2.007858777396993e+02, // 352
             4.501464462345436e-07, // 353
            -1.167989088349279e+01, // 354
             3.914003847067588e+01, // 355
            -1.058138104190737e+02, // 356
             1.266863692839768e+00, // 357
            -1.857752653397232e-04, // 358
             2.897683927396250e+01, // 359
            -2.459608471561590e-03, // 360
            -3.826891518449124e+00, // 361
             1.787991753284832e+00, // 362
            -1.070535721090187e-02, // 363
            -5.647574434845400e-06, // 364
             2.229596322843512e-04, // 365
             6.891761745977851e+01, // 366
             1.248772714033069e+01, // 367
             2.508761135775527e-06, // 368
            -5.078088135034547e+01, // 369
            -1.706469150831528e+01, // 370
             5.058448249329189e+00, // 371
             5.077164157918527e-02, // 372
             2.526686573847892e-04, // 373
             1.277188229529516e+02, // 374
            -1.066197746980813e+01, // 375
             3.075635532300410e+01, // 376
             1.060737440551198e-02, // 377
            -2.635139530553092e+00, // 378
             1.733998790807440e-03, // 379
             5.943238633452562e+01, // 380
             1.285126159336837e+02, // 381
            -2.722500622591992e+01, // 382
             2.514209515236665e+01, // 383
            -1.205893871984560e-04, // 384
             1.593056705498875e-02, // 385
             2.849886290022754e-01, // 386
            -4.029578985621611e+01, // 387
             2.250349708473528e+01, // 388
            -2.701904064569716e+00, // 389
             5.400359880362710e+00, // 390
             1.455955226904686e-01, // 391
            -2.026493302606640e+00, // 392
            -1.409066548705404e-01, // 393
             1.485866957921207e+01, // 394
             1.060461582291164e-01, // 395
             3.117099214684184e-01, // 396
             2.402505500223787e+01, // 397
            -4.861849504129562e+00, // 398
            -4.866002952550240e+00, // 399
            -4.606983917403541e-01, // 400
            -2.092226073626465e-01, // 401
            -1.432669932129631e+01, // 402
             8.467552743657132e-01, // 403
            -2.347601519524499e-01, // 404
            -1.417612313849023e+02, // 405
            -6.824442347534027e+01, // 406
            -1.196194796198880e+00, // 407
            -6.326387495145206e+00, // 408
            -7.922047432405419e-02, // 409
             2.862925193907095e+00, // 410
             8.544646596071706e+01, // 411
             2.860943912980030e+01, // 412
            -1.699848050663678e-03, // 413
            -2.169823594162837e-01, // 414
             3.483303434422906e+01, // 415
             1.640796562852082e+02, // 416
             1.924398101743531e-03, // 417
             1.422330813643972e+00, // 418
             2.475318511902193e+01, // 419
            -9.669421702764809e-02, // 420
            -1.461593460120777e-04, // 421
             4.837281872000013e+01, // 422
            -6.932877293721555e-03, // 423
             1.370864383703387e+01, // 424
            -2.229084880684562e+00, // 425
            -6.612837459186431e+00, // 426
             4.500525151650602e+00, // 427
             5.619586173141381e-04, // 428
            -1.210727039432386e+02, // 429
            -1.838810572923564e+02, // 430
             5.488547669107783e+01, // 431
             8.709762082228952e-07, // 432
             1.894116694753962e+01, // 433
             9.337609265313947e+00, // 434
            -2.853757832213084e+01, // 435
            -1.187919576026129e+01, // 436
            -7.891962957026560e-01, // 437
             8.951554275068709e-02, // 438
            -2.065071763590431e-03, // 439
            -5.251644928749614e+01, // 440
             3.285566423634356e+01, // 441
            -1.321621716228749e+00, // 442
            -7.174652106373887e+01, // 443
            -1.823429627845643e+02, // 444
            -1.245506739264249e+01, // 445
             3.245899047124885e-02, // 446
            -1.673116221620024e+00, // 447
            -1.338312740737204e+02, // 448
            -9.951427104106271e+01, // 449
            -1.522096141363630e+00, // 450
            -2.304014063458281e-03, // 451
             5.523655480486626e-07, // 452
            -6.758367255880610e+01, // 453
            -1.523028367092493e+02, // 454
             5.647118438925293e-04, // 455
             7.822121053681884e+01, // 456
             2.853270563880697e-02, // 457
             5.202125832549834e-04, // 458
             3.302853980926258e+01, // 459
            -6.958324545260557e+01, // 460
            -2.965260599777405e+00, // 461
            -2.371370675410691e+02, // 462
            -6.802496635830733e+00, // 463
            -9.107465125715962e+01, // 464
             1.382547993846670e+02, // 465
            -5.820472117075095e-01, // 466
             4.578622919152503e-04, // 467
             1.713913652020175e+00, // 468
             6.448232286507852e-01, // 469
            -8.751322013791897e-01, // 470
             8.904698852448547e+00, // 471
             2.364948574762214e-01, // 472
             1.024524075079456e-03, // 473
             1.377637813978422e-01, // 474
             5.005323335845364e-01, // 475
             1.517446162588861e-02, // 476
             1.709429881369135e+01, // 477
            -5.158496271493997e-02, // 478
             1.160493178452781e-01, // 479
            -1.189364126834124e-01, // 480
             1.309222721838781e+01, // 481
            -1.731056964712982e+02, // 482
             4.824872056163163e+00, // 483
            -8.375712329024738e-01, // 484
            -1.540717014686793e+02, // 485
             4.228425237196144e-04, // 486
             2.303649563739061e-04, // 487
            -1.841537506827109e-01, // 488
            -1.095600725585536e+02, // 489
            -8.585082546705943e-01, // 490
             7.525072441749166e-04, // 491
             1.181168750177080e-03, // 492
             4.072029410495393e+01, // 493
            -4.075843159553533e-03, // 494
             2.627984566239852e+01, // 495
            -1.095723696983713e+02, // 496
            -1.366631496366865e-01, // 497
             5.463531888339298e-01, // 498
             1.648103668955312e+02, // 499
             1.365859320200940e+02, // 500
            -7.318528755292889e+00, // 501
            -4.776949588001518e-01, // 502
            -1.494537689986120e+02, // 503
             5.874744556388514e-07, // 504
            -3.115729776199860e+00, // 505
            -2.038251932633622e-04, // 506
             1.914743669476321e+01, // 507
             2.870353395843827e-02, // 508
             1.589021133057575e+01, // 509
             1.472582155159288e+01, // 510
             1.307491711867497e-04, // 511
             5.833920010568494e+01, // 512
             2.405276970832999e-01, // 513
            -4.557213679234667e+01, // 514
             2.169336646046406e+02, // 515
             1.268188160567049e+01, // 516
             9.993950461901950e-02, // 517
            -1.425360187722206e+02, // 518
             1.826518497070447e+01, // 519
             2.077232744242070e-05, // 520
             4.924469104062344e+00, // 521
            -1.615766093950038e-01, // 522
            -1.074247410603146e-02, // 523
            -8.556446705848892e+01, // 524
            -3.315774118607020e-07, // 525
            -5.716812121336550e-02, // 526
             4.809410212674315e+00, // 527
            -5.045314255442644e+01, // 528
            -1.757278289870430e-04, // 529
            -7.891183168450299e-01, // 530
            -1.409025076491846e+02, // 531
            -9.227449856067908e+00, // 532
             5.644767427476351e+01, // 533
             4.493014454612360e+00, // 534
            -4.784137509868372e+01, // 535
             2.424674657823469e-01, // 536
            -3.289572028146723e+01, // 537
            -3.995201028567882e+02, // 538
            -3.039007394326151e+00, // 539
            -1.034057786009938e+02, // 540
             2.115999073767119e+02, // 541
             8.640823037373293e+00, // 542
             3.530116061410394e+01, // 543
             1.183891688062628e+01, // 544
             2.163119434971363e-01, // 545
             1.221414544439836e-03, // 546
             1.117803222354660e+01, // 547
             7.432190878209929e+01, // 548
             8.529382094874987e+01, // 549
            -7.408469987551866e+00, // 550
             1.797485949262485e-03, // 551
            -1.234703066106366e+02, // 552
             1.095251535477044e-02, // 553
             6.514223900212857e+00, // 554
             2.845317707925620e+01, // 555
            -5.581079790878505e+01, // 556
             1.733790604748764e+00, // 557
            -3.210818669206179e+01, // 558
             5.287956061601197e+01, // 559
            -9.087832747137536e-02, // 560
             8.129575382142095e+00, // 561
             1.720854287324952e+02, // 562
            -2.828784187173062e-01, // 563
             9.230860014890538e-04, // 564
             6.067136757232793e+01, // 565
             2.850935879713463e-01, // 566
             1.052534988699854e-01, // 567
            -4.557917337956982e+01, // 568
             9.571678331497813e-02, // 569
            -1.170779034835840e+00, // 570
            -9.602544854161754e-02, // 571
            -3.548043088409085e+00, // 572
             1.635687060664544e+02, // 573
            -1.598722438608839e-02, // 574
             7.918406414488957e+00, // 575
            -1.370093466223695e+02, // 576
             2.279202354275866e-02, // 577
            -2.684655648467595e+02, // 578
             1.397213507902351e+02, // 579
             8.317412202533417e-05, // 580
            -5.565504899992345e-05, // 581
            -1.476335357477572e+02, // 582
             1.629409880268734e+02, // 583
             2.023688679880247e+01, // 584
            -9.341662534120097e+00, // 585
            -3.968273381006390e+01, // 586
            -3.454260539503753e+01, // 587
             3.107129796510855e+01, // 588
             1.105388537377369e+01, // 589
            -2.004616370687490e+01, // 590
             4.414718280384084e+01, // 591
            -7.217988809718315e-02, // 592
             6.583179058938795e+00, // 593
            -5.927916696791024e+00, // 594
             2.108230165846322e+00, // 595
            -2.146869381057893e-02, // 596
            -1.338478703504457e+02, // 597
            -4.550856605460536e-01, // 598
            -2.870853705912857e-02, // 599
             1.902778975054651e+01, // 600
             2.027356895513387e-01, // 601
             1.000718523544894e+02, // 602
             3.871051097961919e+01, // 603
            -1.650779126171043e+02, // 604
            -1.973678584670742e+02, // 605
             7.948797215619305e+01, // 606
            -6.857991663563941e-02, // 607
             2.062550500322369e+01, // 608
            -1.517482675371413e+02, // 609
            -2.832037677226980e-03, // 610
            -2.413637826773541e+02, // 611
             2.462832946028870e+00, // 612
            -8.109055069912364e-04, // 613
            -1.339939167023933e+01, // 614
             1.230118917105771e+02, // 615
            -7.484663927101660e+01, // 616
             4.003680218604155e+01, // 617
            -3.617143341590471e-01, // 618
             1.772820852975567e+01, // 619
            -5.495380486401051e+01, // 620
            -2.507195884643505e+01, // 621
            -1.341227432572775e-03, // 622
             2.959432204916208e+01, // 623
            -8.387090478993326e+00, // 624
             1.983598389119140e+02, // 625
             2.563816120879447e-02, // 626
            -5.668832834077356e+01, // 627
             3.338775751194405e+00, // 628
             2.992666445435904e+02, // 629
            -5.376011400215664e+01, // 630
            -4.973112418424280e+00, // 631
             6.921278438240558e-01, // 632
            -1.084477292804483e+01, // 633
             1.609252996604795e-02, // 634
             2.507939786880747e+01, // 635
             3.487738500849852e-01, // 636
             2.126657516589273e+01, // 637
            -3.357883379045293e+00, // 638
             6.997555752867112e+01, // 639
            -7.618345203546723e+01, // 640
            -6.214289267251610e-02, // 641
             7.086892884634356e+01, // 642
            -5.445289411772207e+00, // 643
             2.429958922495306e+00, // 644
             2.601805334144258e+00, // 645
             1.046691266329072e+02, // 646
            -1.616230134153214e+02, // 647
             8.630260395186397e-04, // 648
             8.254763124812973e+00, // 649
             3.828811859627275e+01, // 650
             2.091467022839924e+00, // 651
             2.346998798979892e-01, // 652
            -4.368836866692010e-03, // 653
             2.060738976127111e-03, // 654
             9.281560294795617e-02, // 655
            -7.203395032668175e-05, // 656
             1.320724388045149e+00, // 657
             3.918688133391631e+02, // 658
             4.795144082567638e+01, // 659
            -3.730924314188611e+01, // 660
            -6.345193256508023e+00, // 661
             1.259222961553647e+02, // 662
             1.547554903867438e+01, // 663
            -1.674114109765005e+02, // 664
             6.100123992185963e+01, // 665
            -2.601458907328854e-02, // 666
            -4.770034661547007e+01, // 667
             1.979152309789970e+00, // 668
             1.487051185593523e+01, // 669
             6.098202780016611e+01, // 670
            -6.987073249756693e+01, // 671
            -5.539422212605054e-02, // 672
            -1.779175291589700e+02, // 673
             2.099585013457811e+01, // 674
             3.728564797526027e+01, // 675
            -1.800966544048625e+01, // 676
             5.657952738389955e+01, // 677
             1.735552027344940e-02, // 678
            -7.864127029098632e+00, // 679
            -6.032050549403498e-01, // 680
             6.581261346500557e+01, // 681
             9.012334987760869e-02, // 682
            -3.086865545799412e+01, // 683
            -1.498307179732018e+02, // 684
            -1.313109906627602e-03, // 685
            -3.364272616609387e+01, // 686
            -2.067196496522308e+02, // 687
             5.004199659064342e+01, // 688
            -1.025044574821693e+01, // 689
             2.535440169542878e+01, // 690
             1.281525705686190e+01, // 691
            -4.337738185646148e+01, // 692
            -5.216974144436237e-04, // 693
             7.787311959138734e+01, // 694
             6.635582179532526e+01, // 695
             1.557589865732593e+00, // 696
             4.065767123307671e+01, // 697
             7.123889445170758e-05, // 698
             1.222676579852709e+02, // 699
             3.066593750377162e+02, // 700
             5.756714950125409e+01, // 701
             2.580781189165107e+00, // 702
            -1.696645265729583e-04, // 703
             7.286959072220170e-02, // 704
            -8.681167220254099e+01, // 705
             1.885293740292953e+01, // 706
             1.007691195239985e+00, // 707
             1.397168339486021e+01, // 708
            -1.802362030149964e+00, // 709
             1.228941512434367e+02, // 710
            -1.116024771282917e+02, // 711
             1.383419196215988e-02, // 712
             1.173739153966401e+02, // 713
             1.549384808851242e+02, // 714
            -1.507563920164643e-01, // 715
             2.123774391798457e-01, // 716
             2.051199807485271e-01, // 717
            -1.653334534391062e+01, // 718
             6.536799944239152e+01, // 719
             5.260010095622494e+01, // 720
            -7.393148963594151e-02, // 721
             5.976967792708079e-01, // 722
             1.503961785161791e-01, // 723
            -1.008957712868108e+00, // 724
            -1.643425589598440e+02, // 725
            -9.373327637449076e+01, // 726
             5.997552018019410e+01, // 727
            -1.153430880692739e-01, // 728
             4.118961105715092e+02, // 729
             8.353287468240457e+01, // 730
             1.260204578153155e+02, // 731
            -8.920289907045240e+01, // 732
             2.488386086392455e-02, // 733
             1.181793154792919e-03, // 734
             3.463534754870501e+01, // 735
            -6.412039971793610e+01, // 736
            -8.260022929099320e-02, // 737
            -1.888823667081235e+01, // 738
            -2.655966301997915e-01, // 739
            -2.923786128522445e+01, // 740
             9.596547591339388e-02, // 741
             1.108813686788028e+00, // 742
             5.298400798619715e+01, // 743
             1.221472444230120e+00, // 744
             6.468541494077212e+01, // 745
             3.419244902046649e+02, // 746
            -5.874710071669438e-04, // 747
             3.149743116136802e-01, // 748
            -1.273404622359609e+00, // 749
            -8.205152715738377e-02, // 750
             4.670388438100367e+01, // 751
             4.752345507500828e+00, // 752
             7.491972611429783e-02, // 753
            -1.088724152183752e-03, // 754
            -9.934358578830318e-01, // 755
             4.968966725801015e+00, // 756
             1.273213617893532e+02, // 757
            -7.550425077911964e-02, // 758
             4.275582939812114e+01, // 759
            -2.266550210796571e-01, // 760
             1.654356710794176e+01, // 761
            -7.274578081194956e+01, // 762
             2.279665758558888e+02, // 763
            -2.696276089228983e+02, // 764
            -1.496714432717162e+01, // 765
             7.013141483863238e+00, // 766
             1.322494029772550e+00, // 767
             3.011244842060000e+02, // 768
             1.285160390690208e+01, // 769
             9.443679068572337e+01, // 770
             2.464255485838872e+01, // 771
             5.762574964336847e+01, // 772
            -1.632413462929215e+01, // 773
             1.857933768335905e+01, // 774
            -3.092510615751568e+01, // 775
            -1.325191010553182e-01, // 776
             1.409569600163717e+02, // 777
            -1.195000101124301e+01, // 778
             2.940289152682984e+00, // 779
            -7.736864835170368e+01, // 780
            -1.834158741051170e-02, // 781
            -3.921882757425598e+01, // 782
            -6.878782514703246e+00, // 783
             3.469335642653834e-01, // 784
             1.389896517590570e-01, // 785
             2.092174142165278e-01, // 786
             5.942217074294021e+01, // 787
            -2.308934968212312e-01, // 788
            -5.147804556672445e+00, // 789
            -1.185801800718063e-01, // 790
             1.575085007470476e-01, // 791
            -3.260384565658450e+01, // 792
             1.603027475756898e+00, // 793
             1.485400493666228e+02, // 794
            -1.436244882152610e+01, // 795
            -6.449250911058397e-01, // 796
             1.446609334276934e-01, // 797
             8.261309145325819e+01, // 798
            -1.746551317680757e+02, // 799
             1.425450429733709e+02, // 800
            -2.221009803120184e-02, // 801
             2.883273008967393e+01, // 802
             1.095316278653019e+00, // 803
             1.547079701959518e+02, // 804
             1.336283277968518e-02, // 805
            -7.845881046061922e+00, // 806
             3.032224310177103e+02, // 807
            -2.700203485968319e-01, // 808
            -2.072242499507394e+02, // 809
            -9.125743628732344e+01, // 810
             1.031740336983143e+02, // 811
             3.636861043566712e+01, // 812
             1.610685068571012e+02, // 813
             5.005986332328533e-05, // 814
            -3.900590434481354e+01, // 815
            -5.263065000249972e+01, // 816
             9.915855195959954e+01, // 817
            -2.003719223269179e+01, // 818
            -3.978580651688264e+01, // 819
             3.213267730361824e-05, // 820
            -1.590200347922317e+00, // 821
            -4.013757108589103e+01, // 822
            -2.669738478602465e+02, // 823
             7.416704174115980e+00, // 824
             2.120625922439552e-02, // 825
            -3.358786798342197e+01, // 826
             5.406579030213229e+01, // 827
            -1.514779856623160e+01, // 828
             3.562525532644938e+01, // 829
             1.933778300186774e+00, // 830
             2.094556443062930e+01, // 831
            -7.769837395186890e+01, // 832
             1.456383838162563e+01, // 833
            -2.463164289463746e+01, // 834
             3.664362089246619e+01, // 835
            -8.246327642477234e-02, // 836
             1.024767057774768e+02, // 837
            -1.235602416650038e+01, // 838
             1.562024754751104e-01, // 839
             1.132994345562882e+02, // 840
            -1.390776742033796e+02, // 841
             2.011148811491372e+01, // 842
            -1.275023447051901e+02, // 843
             8.975044371747852e-04, // 844
             4.810426290592554e+01, // 845
            -1.134815002120383e+02, // 846
             9.057076102080052e-01, // 847
            -8.810187917316211e+00, // 848
            -5.112202904904476e+01, // 849
             4.031801001905300e-02, // 850
            -1.400923604729769e-04, // 851
            -3.086838035282176e+01, // 852
             2.095797502047138e+01, // 853
            -2.762833786383628e+00, // 854
            -1.698335028863824e+02, // 855
             1.210898654997794e-04, // 856
            -3.806863952366057e+01, // 857
            -7.829730696198109e+01, // 858
             5.793474374784028e-01, // 859
            -8.451584913230990e+00, // 860
            -1.537546021556739e+01, // 861
            -1.999001697908599e+00, // 862
             6.832151951359446e+00, // 863
            -4.385888282888317e-02, // 864
            -3.829060017659782e+00, // 865
            -2.244451589579783e-01, // 866
            -6.126941376486866e-02, // 867
             2.579716213807118e+01, // 868
            -2.500467866702532e-02, // 869
             2.041767774611371e+00, // 870
            -2.430944609901101e+02, // 871
             8.956113252853382e-01, // 872
            -9.049000968013750e-02, // 873
            -4.894210548658732e+01, // 874
            -9.106031557025020e-02, // 875
             1.263371361886970e-03, // 876
            -2.175962951550710e+01, // 877
            -2.983826102828233e+01, // 878
            -6.897564848254405e-01, // 879
            -6.773147590983351e+01, // 880
             6.208346301360458e-02, // 881
            -9.435971082054641e+01, // 882
            -7.208488788352338e+01, // 883
            -1.593983712883536e+01, // 884
            -4.365953608970476e-02, // 885
            -7.504897101441223e-05, // 886
             7.501004052221054e+00, // 887
            -1.596652060226464e-01, // 888
             4.375749031306032e+01, // 889
            -2.973958992070389e+02, // 890
             1.228393076739666e+00, // 891
            -1.762835366850870e+00, // 892
            -1.102373851233581e+00, // 893
             3.847006539543795e-01, // 894
             3.661984014862406e+01, // 895
             9.816580210909871e-06, // 896
             1.447814181571288e-02, // 897
            -2.417194505034765e+00, // 898
            -8.112361132881377e+00, // 899
            -1.147556731097223e+02, // 900
            -3.691848419252962e-01, // 901
             2.065689485259105e+01, // 902
            -1.292261647826567e+02, // 903
            -1.050254679540906e+02, // 904
            -3.865271075262876e-05, // 905
             5.369018389937934e+00, // 906
             1.093116823796997e-04, // 907
             8.246222711589004e-05, // 908
             1.826988871237888e+01, // 909
            -1.528479825234706e-01, // 910
            -2.315242649526278e+00, // 911
            -5.072964193851619e-01, // 912
             8.576047114300577e+01, // 913
             2.529741088284262e+01, // 914
             2.235636896638926e+02, // 915
             6.298141605642180e-02, // 916
             4.581570821021722e-02, // 917
             2.013524060402608e+00, // 918
            -2.261866233448287e+01, // 919
            -5.597660094472860e+01, // 920
             1.186332747605633e+02, // 921
            -3.634515038374398e+01, // 922
             9.025296520543664e+00, // 923
             1.287649753743272e+01, // 924
             6.031513072871272e+00, // 925
            -1.364185020569898e-02, // 926
            -1.695827289839330e+02, // 927
            -9.979952919955549e+01, // 928
             2.462888543960086e+00, // 929
            -4.111234796367925e-02, // 930
             8.267610508848651e+01, // 931
             8.986647209676574e+00, // 932
             2.769136805708694e+01, // 933
            -5.519817953709727e-02, // 934
             3.582041110591954e+01, // 935
            -1.908303754615254e+02, // 936
             1.118153661304040e+02, // 937
             7.128558521163537e+00, // 938
            -1.962122141817557e+01, // 939
            -1.765069585133802e+01, // 940
             1.049186694230058e+02, // 941
            -1.834900342563775e+01, // 942
            -4.078200406185379e+01, // 943
             1.265280770277896e-01, // 944
             4.159931899314024e-01, // 945
            -1.371281978768182e+02, // 946
             9.155184722840346e+01, // 947
            -6.155554023036512e+01, // 948
             7.950414470877072e-02, // 949
            -1.396709517220151e+00, // 950
            -9.108039452735894e-02, // 951
             3.703637234282751e-02, // 952
            -3.623801408039835e+02, // 953
            -1.514838299179625e+00, // 954
             2.211645256254692e+02, // 955
             1.876732463788532e+02, // 956
            -1.715762802294312e+02, // 957
            -1.045433938894599e+01, // 958
            -1.121639402422106e+02, // 959
             1.098514325367057e+02, // 960
            -5.427645927370530e+00, // 961
            -6.297072457615100e+00, // 962
            -1.874609311696602e+02, // 963
            -1.385927869574165e+02, // 964
             4.044636045735603e+01, // 965
             2.882690237688521e-01, // 966
            -2.089020067550082e-02, // 967
            -1.305744646023413e-04, // 968
             6.401168687219720e-02, // 969
            -1.243902777368842e-02, // 970
             2.238307404596479e+01, // 971
             4.335737943033304e+01, // 972
            -8.886419545163872e-02, // 973
             7.692444115323755e+00, // 974
            -1.638559467170536e+02, // 975
            -1.492255456774883e+01, // 976
             8.927434411592985e+01, // 977
             1.935877357787016e+02, // 978
            -9.849539660545268e+00, // 979
             1.238347811240278e-02, // 980
             1.024937727627344e+01, // 981
             1.927967064464981e-01, // 982
             2.469298483676105e+02, // 983
            -7.211885195123910e-02, // 984
             8.325088367752931e-02, // 985
            -8.983665283252655e-02, // 986
            -1.732590270183360e+01, // 987
             1.142948108740602e+00, // 988
            -5.875263863036941e+01, // 989
             6.443938913156494e-02, // 990
            -1.505847597985806e+02, // 991
             3.969361152466383e+00, // 992
            -1.785518717194223e+01, // 993
             1.276128230566057e+02, // 994
            -2.023552418764339e+00, // 995
             1.018004977979430e+01, // 996
             9.307827201022957e-02, // 997
             9.573880670724307e+01, // 998
            -1.048657859810233e+02, // 999
            -2.499912807066360e+02, // 1000
            -1.471868529895511e+02, // 1001
            -6.427912432652438e+00, // 1002
            -4.268637923455271e+00, // 1003
            -8.066453171946839e-01, // 1004
            -9.714558517587685e-01, // 1005
             1.326604977398873e+01, // 1006
            -1.946068791140388e-01, // 1007
            -1.469027722252616e+02, // 1008
            -5.516564971139379e+01, // 1009
             9.956812432213215e+01, // 1010
             1.122250776983176e+01, // 1011
             3.210726083245005e+01, // 1012
            -4.971392634242245e-01, // 1013
            -1.718521135464806e+02, // 1014
            -6.572840257246362e+01, // 1015
            -1.759234114763574e+01, // 1016
            -1.789210032802210e-02, // 1017
             5.390902317842756e+01, // 1018
            -1.793001540807588e-01, // 1019
            -1.737479047718956e+02, // 1020
            -4.971857402158225e+01, // 1021
             3.130389999629661e+00, // 1022
            -6.925786892410630e+01, // 1023
             1.066699005172666e-03, // 1024
            -6.237948553341548e+01, // 1025
             2.665160074674334e+01, // 1026
             2.986837646573575e+00, // 1027
            -1.254921208414913e+02, // 1028
            -7.326503652188005e+00, // 1029
            -3.909444884484901e-01, // 1030
             8.398575927313147e-01, // 1031
             1.191842860143246e+01, // 1032
             2.535851816194596e+02, // 1033
             6.936185917313205e-02, // 1034
            -4.418076588449654e+01, // 1035
            -8.275713779414643e+01, // 1036
            -9.570437142066790e+01, // 1037
             1.987797192228664e-04, // 1038
            -6.222253702653646e+01, // 1039
            -1.117682840576533e+00, // 1040
            -5.328880540353628e+01, // 1041
            -1.548858262380231e+01, // 1042
            -1.042361344482015e+01, // 1043
            -3.060933882925754e+01, // 1044
            -8.610946995796960e+00, // 1045
            -1.265128443120739e+01, // 1046
            -1.342405122880774e+02, // 1047
             2.474064119421651e+01, // 1048
             6.515492221292129e+01, // 1049
             2.703114267595068e+01, // 1050
             1.093938436539355e-01, // 1051
             1.981182612494067e-01, // 1052
            -5.665069600328646e-03, // 1053
             6.006616444986415e+01, // 1054
            -8.298559907832793e+00, // 1055
             1.920601243095076e+00, // 1056
             5.748051253012184e+01, // 1057
            -3.165279028568012e-01, // 1058
             1.571598330108882e+02, // 1059
            -8.443921062325381e+01, // 1060
            -1.425579444674870e-01, // 1061
             3.575163102177335e+02, // 1062
             6.208604394200967e+00, // 1063
            -2.450030056112147e+02, // 1064
            -2.133201044395686e-03, // 1065
            -6.987721631545473e-01, // 1066
            -1.600646118264563e+02, // 1067
             3.443256727941790e-04, // 1068
             5.391003585153927e+00, // 1069
             2.255524802574189e+01, // 1070
             1.032668140280532e+02, // 1071
             5.374810914118932e-01, // 1072
            -2.115088145340042e+02, // 1073
            -6.578570421114554e+01, // 1074
            -6.434476299383914e+01, // 1075
             1.948602299135587e+01, // 1076
            -1.972936063146311e+01, // 1077
            -1.155057044884099e+02, // 1078
             8.032070540399365e-03, // 1079
             3.729746987419282e-01, // 1080
            -1.092860876242446e+02, // 1081
            -3.859756570143306e+01, // 1082
             2.516783747056828e+02, // 1083
             8.697970084812638e+01, // 1084
            -9.060218658278658e-01, // 1085
            -6.765080182994572e+01, // 1086
             1.231028452891097e-04, // 1087
            -9.205044168404154e-04, // 1088
             5.648401961706819e+01, // 1089
            -4.963346870175152e+00, // 1090
             5.606583654321962e-05, // 1091
             1.567174406405340e+01, // 1092
            -1.238837944826140e+01, // 1093
            -1.362426167994132e+02, // 1094
            -9.722269609757538e-04, // 1095
            -7.286271298322928e-01, // 1096
             6.454754685443949e-02, // 1097
             8.147566402397370e+00, // 1098
            -1.009712669635342e+02, // 1099
             3.594669161475169e+00, // 1100
            -2.455520907425480e+01, // 1101
            -2.442774986319962e+02, // 1102
             1.962713062307093e+02, // 1103
             1.491754147880262e-03, // 1104
             1.594084545909356e+02, // 1105
            -5.609515183523393e+01, // 1106
            -7.411752440879163e-02, // 1107
             2.823840449202865e+01, // 1108
             7.395465132169056e+01, // 1109
             2.341096556880789e+02, // 1110
             5.103122270396572e-02, // 1111
             2.181492870340077e-02, // 1112
            -5.494224615987779e-02, // 1113
             1.338588376940758e+02, // 1114
             1.016145518874132e+02, // 1115
             1.849088847122032e-03, // 1116
             1.780208359978837e+01, // 1117
            -1.454410998118163e+01, // 1118
            -5.898140893644909e+01, // 1119
            -5.371463903812125e+00, // 1120
             1.705982871711289e-01, // 1121
             4.704220189452986e-01, // 1122
            -1.828255211001921e+01, // 1123
            -2.270946998975568e+02, // 1124
            -2.790352893262085e-03, // 1125
            -3.474599285429817e-04, // 1126
             6.025868643544197e+01, // 1127
            -6.081791376750809e+01, // 1128
             1.053723484928165e+02, // 1129
             1.666874400496571e-01, // 1130
            -8.320098061453200e+00, // 1131
             2.119882345776353e+02, // 1132
             2.051988907131745e+02, // 1133
            -2.079650676209143e+02, // 1134
            -2.974026147087795e+01, // 1135
            -1.175722773867838e-03, // 1136
             4.993388529860572e+00, // 1137
            -1.621006205308220e-01, // 1138
             3.582882765803919e+01, // 1139
             4.474515493817300e+01, // 1140
             1.281658016754521e+02, // 1141
            -5.394156993186028e+01, // 1142
            -4.076838593241361e+01, // 1143
             3.209275523360606e+01, // 1144
             1.926183744524257e-04, // 1145
            -5.989520985653312e-01, // 1146
            -2.971296853814982e+01, // 1147
             6.512783782666419e+00, // 1148
            -1.212357838467913e+00, // 1149
             6.624794149816684e+01, // 1150
            -5.822277928518244e-04, // 1151
            -7.302231130779039e+01}; // 1152
    m_k_x_inter_A_A_0 =  1.288065536944707e-01; // A^(-1))
    m_k_x_intra_A_B_1 =  3.153017277135879e-01; // A^(-1))
    m_k_x_inter_A_B_0 =  2.849661510872341e+00; // A^(-1))
    m_k_x_inter_A_Z_0 =  1.062978859037556e+00; // A^(-1))
    m_k_x_intra_B_B_1 =  1.312079447057797e-01; // A^(-1))
    m_k_x_inter_B_B_0 =  6.400138557694629e-01; // A^(-1))
    m_k_x_inter_B_Z_0 =  8.279509604145403e-01; // A^(-1))
    m_k_x_inter_Z_Z_0 =  1.007495331550538e+00; // A^(-1))
    m_ri =  4.500000000000000e+00; // A
    m_ro =  6.500000000000000e+00; // A

    } // end if mon1 == "h2o_mb" and mon2 == "h2o_mb"
    // =====>> END SECTION CONSTRUCTOR <<=====
}

//----------------------------------------------------------------------------//

double mbnrg_A1B2Z2_A1B2Z2_deg4_v1::f_switch(const double r, double& g)
{
    if (r > m_ro) {
        g = 0.0;
        return 0.0;
    } else if (r > m_ri) {
        const double t1 = M_PI/(m_ro - m_ri);
        const double x = (r - m_ri)*t1;
        g = - std::sin(x)*t1/2.0;
        return (1.0 + std::cos(x))/2.0;
    } else {
        g = 0.0;
        return 1.0;
    }
}

//----------------------------------------------------------------------------//

 double mbnrg_A1B2Z2_A1B2Z2_deg4_v1::eval(const double *xyz1, const double *xyz2, const size_t n) {
    std::vector<double> energies(n,0.0);
    std::vector<double> energies_sw(n,0.0);

    std::vector<double> xyz(18);
    double sw = 0.0;
    polynomial my_poly;

    for (size_t j = 0; j < n; j++) {
        const double *mon1 = xyz1 + 9*j;
        const double *mon2 = xyz2 + 9*j;


        const double d12[3] =
                         {mon1[0] - mon2[0],
                          mon1[1] - mon2[1],
                          mon1[2] - mon2[2]};

        const double d12rsq = d12[0]*d12[0] + d12[1]*d12[1] + d12[2]*d12[2];
        const double d12r = std::sqrt(d12rsq);

        if (true  && d12r > m_ro ) {
             continue;
        }

        std::copy(mon1, mon1 + 9, xyz.begin() + 0);

        std::copy(mon2, mon2 + 9, xyz.begin() + 9);


        const double* coords_A_1_a = xyz.data() + 0;

        const double* coords_B_1_a = xyz.data() + 3;

        const double* coords_B_2_a = xyz.data() + 6;

        const double* coords_A_1_b = xyz.data() + 9;

        const double* coords_B_3_b = xyz.data() + 12;

        const double* coords_B_4_b = xyz.data() + 15;

        double coords_Z_1_a[3];
        std::fill(coords_Z_1_a,coords_Z_1_a + 3, 0.0);

        double coords_Z_2_a[3];
        std::fill(coords_Z_2_a,coords_Z_2_a + 3, 0.0);

        double coords_Z_1_b[3];
        std::fill(coords_Z_1_b,coords_Z_1_b + 3, 0.0);

        double coords_Z_2_b[3];
        std::fill(coords_Z_2_b,coords_Z_2_b + 3, 0.0);


        double w12 =     -9.721486914088159e-02;  //from MBpol
        double w13 =     -9.721486914088159e-02;
        double wcross =   9.859272078406150e-02;

    
        monomer m1;
        m1.setup(coords_A_1_a, w12, wcross, coords_Z_1_a, coords_Z_2_a);

        monomer m2;
        m2.setup(coords_A_1_b, w12, wcross, coords_Z_1_b, coords_Z_2_b);

        variable vs[31];
        const double d0_intra = 1.0;
        const double d0_inter = 4.0;

        double xs[31];

        xs[0] = vs[0].v_coul0(d0_inter, m_k_x_inter_A_A_0, coords_A_1_a, coords_A_1_b);
        xs[1] = vs[1].v_exp0(d0_intra, m_k_x_intra_A_B_1, coords_A_1_a, coords_B_1_a);
        xs[2] = vs[2].v_exp0(d0_intra, m_k_x_intra_A_B_1, coords_A_1_a, coords_B_2_a);
        xs[3] = vs[3].v_coul0(d0_inter, m_k_x_inter_A_B_0, coords_A_1_a, coords_B_3_b);
        xs[4] = vs[4].v_coul0(d0_inter, m_k_x_inter_A_B_0, coords_A_1_a, coords_B_4_b);
        xs[5] = vs[5].v_exp0(d0_inter, m_k_x_inter_A_Z_0, coords_A_1_a, coords_Z_1_b);
        xs[6] = vs[6].v_exp0(d0_inter, m_k_x_inter_A_Z_0, coords_A_1_a, coords_Z_2_b);
        xs[7] = vs[7].v_coul0(d0_inter, m_k_x_inter_A_B_0, coords_A_1_b, coords_B_1_a);
        xs[8] = vs[8].v_coul0(d0_inter, m_k_x_inter_A_B_0, coords_A_1_b, coords_B_2_a);
        xs[9] = vs[9].v_exp0(d0_intra, m_k_x_intra_A_B_1, coords_A_1_b, coords_B_3_b);
        xs[10] = vs[10].v_exp0(d0_intra, m_k_x_intra_A_B_1, coords_A_1_b, coords_B_4_b);
        xs[11] = vs[11].v_exp0(d0_inter, m_k_x_inter_A_Z_0, coords_A_1_b, coords_Z_1_a);
        xs[12] = vs[12].v_exp0(d0_inter, m_k_x_inter_A_Z_0, coords_A_1_b, coords_Z_2_a);
        xs[13] = vs[13].v_exp0(d0_intra, m_k_x_intra_B_B_1, coords_B_1_a, coords_B_2_a);
        xs[14] = vs[14].v_coul0(d0_inter, m_k_x_inter_B_B_0, coords_B_1_a, coords_B_3_b);
        xs[15] = vs[15].v_coul0(d0_inter, m_k_x_inter_B_B_0, coords_B_1_a, coords_B_4_b);
        xs[16] = vs[16].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_1_a, coords_Z_1_b);
        xs[17] = vs[17].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_1_a, coords_Z_2_b);
        xs[18] = vs[18].v_coul0(d0_inter, m_k_x_inter_B_B_0, coords_B_2_a, coords_B_3_b);
        xs[19] = vs[19].v_coul0(d0_inter, m_k_x_inter_B_B_0, coords_B_2_a, coords_B_4_b);
        xs[20] = vs[20].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_2_a, coords_Z_1_b);
        xs[21] = vs[21].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_2_a, coords_Z_2_b);
        xs[22] = vs[22].v_exp0(d0_intra, m_k_x_intra_B_B_1, coords_B_3_b, coords_B_4_b);
        xs[23] = vs[23].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_3_b, coords_Z_1_a);
        xs[24] = vs[24].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_3_b, coords_Z_2_a);
        xs[25] = vs[25].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_4_b, coords_Z_1_a);
        xs[26] = vs[26].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_4_b, coords_Z_2_a);
        xs[27] = vs[27].v_exp0(d0_inter, m_k_x_inter_Z_Z_0, coords_Z_1_a, coords_Z_1_b);
        xs[28] = vs[28].v_exp0(d0_inter, m_k_x_inter_Z_Z_0, coords_Z_1_a, coords_Z_2_b);
        xs[29] = vs[29].v_exp0(d0_inter, m_k_x_inter_Z_Z_0, coords_Z_2_a, coords_Z_1_b);
        xs[30] = vs[30].v_exp0(d0_inter, m_k_x_inter_Z_Z_0, coords_Z_2_a, coords_Z_2_b);

        double gsw12 = 0.0;
        double sw12 = f_switch(d12r, gsw12);

        sw = sw12;

        energies[j] = my_poly.eval(xs,coefficients.data());
        energies_sw[j] = energies[j]*sw;

    }

    double energy = 0.0;
    for (size_t i = 0; i < n; i++)
        energy += energies_sw[i];

    return energy;

}

//----------------------------------------------------------------------------//

double mbnrg_A1B2Z2_A1B2Z2_deg4_v1::eval(const double *xyz1, const double *xyz2, double *grad1, double *grad2 , const size_t n, std::vector<double> *virial) {
    std::vector<double> energies(n,0.0);
    std::vector<double> energies_sw(n,0.0);

    std::vector<double> xyz(18);
    double sw = 0.0;
    polynomial my_poly;

    for (size_t j = 0; j < n; j++) {
        const double *mon1 = xyz1 + 9*j;
        const double *mon2 = xyz2 + 9*j;


        const double d12[3] =
                         {mon1[0] - mon2[0],
                          mon1[1] - mon2[1],
                          mon1[2] - mon2[2]};

        const double d12rsq = d12[0]*d12[0] + d12[1]*d12[1] + d12[2]*d12[2];
        const double d12r = std::sqrt(d12rsq);

        if (true  && d12r > m_ro ) {
             continue;
        }

        std::vector<double> gradients(18,0.0);

        std::copy(mon1, mon1 + 9, xyz.begin() + 0);

        std::copy(mon2, mon2 + 9, xyz.begin() + 9);
        const double* coords_A_1_a = xyz.data() + 0;

        const double* coords_B_1_a = xyz.data() + 3;

        const double* coords_B_2_a = xyz.data() + 6;

        const double* coords_A_1_b = xyz.data() + 9;

        const double* coords_B_3_b = xyz.data() + 12;

        const double* coords_B_4_b = xyz.data() + 15;

        double coords_Z_1_a[3];
        std::fill(coords_Z_1_a,coords_Z_1_a + 3, 0.0);

        double coords_Z_2_a[3];
        std::fill(coords_Z_2_a,coords_Z_2_a + 3, 0.0);

        double coords_Z_1_b[3];
        std::fill(coords_Z_1_b,coords_Z_1_b + 3, 0.0);

        double coords_Z_2_b[3];
        std::fill(coords_Z_2_b,coords_Z_2_b + 3, 0.0);


        double* coords_A_1_a_g = gradients.data() + 0;

        double* coords_B_1_a_g = gradients.data() + 3;

        double* coords_B_2_a_g = gradients.data() + 6;

        double* coords_A_1_b_g = gradients.data() + 9;

        double* coords_B_3_b_g = gradients.data() + 12;

        double* coords_B_4_b_g = gradients.data() + 15;

        double coords_Z_1_a_g[3];
        std::fill(coords_Z_1_a_g,coords_Z_1_a_g + 3, 0.0);

        double coords_Z_2_a_g[3];
        std::fill(coords_Z_2_a_g,coords_Z_2_a_g + 3, 0.0);

        double coords_Z_1_b_g[3];
        std::fill(coords_Z_1_b_g,coords_Z_1_b_g + 3, 0.0);

        double coords_Z_2_b_g[3];
        std::fill(coords_Z_2_b_g,coords_Z_2_b_g + 3, 0.0);



        double w12 =     -9.721486914088159e-02;  //from MBpol
        double w13 =     -9.721486914088159e-02;
        double wcross =   9.859272078406150e-02;

    
        monomer m1;
        m1.setup(coords_A_1_a, w12, wcross, coords_Z_1_a, coords_Z_2_a);

        monomer m2;
        m2.setup(coords_A_1_b, w12, wcross, coords_Z_1_b, coords_Z_2_b);

        variable vs[31];
        const double d0_intra = 1.0;
        const double d0_inter = 4.0;

        double xs[31];


        double gxs[31];

        xs[0] = vs[0].v_coul0(d0_inter, m_k_x_inter_A_A_0, coords_A_1_a, coords_A_1_b);
        xs[1] = vs[1].v_exp0(d0_intra, m_k_x_intra_A_B_1, coords_A_1_a, coords_B_1_a);
        xs[2] = vs[2].v_exp0(d0_intra, m_k_x_intra_A_B_1, coords_A_1_a, coords_B_2_a);
        xs[3] = vs[3].v_coul0(d0_inter, m_k_x_inter_A_B_0, coords_A_1_a, coords_B_3_b);
        xs[4] = vs[4].v_coul0(d0_inter, m_k_x_inter_A_B_0, coords_A_1_a, coords_B_4_b);
        xs[5] = vs[5].v_exp0(d0_inter, m_k_x_inter_A_Z_0, coords_A_1_a, coords_Z_1_b);
        xs[6] = vs[6].v_exp0(d0_inter, m_k_x_inter_A_Z_0, coords_A_1_a, coords_Z_2_b);
        xs[7] = vs[7].v_coul0(d0_inter, m_k_x_inter_A_B_0, coords_A_1_b, coords_B_1_a);
        xs[8] = vs[8].v_coul0(d0_inter, m_k_x_inter_A_B_0, coords_A_1_b, coords_B_2_a);
        xs[9] = vs[9].v_exp0(d0_intra, m_k_x_intra_A_B_1, coords_A_1_b, coords_B_3_b);
        xs[10] = vs[10].v_exp0(d0_intra, m_k_x_intra_A_B_1, coords_A_1_b, coords_B_4_b);
        xs[11] = vs[11].v_exp0(d0_inter, m_k_x_inter_A_Z_0, coords_A_1_b, coords_Z_1_a);
        xs[12] = vs[12].v_exp0(d0_inter, m_k_x_inter_A_Z_0, coords_A_1_b, coords_Z_2_a);
        xs[13] = vs[13].v_exp0(d0_intra, m_k_x_intra_B_B_1, coords_B_1_a, coords_B_2_a);
        xs[14] = vs[14].v_coul0(d0_inter, m_k_x_inter_B_B_0, coords_B_1_a, coords_B_3_b);
        xs[15] = vs[15].v_coul0(d0_inter, m_k_x_inter_B_B_0, coords_B_1_a, coords_B_4_b);
        xs[16] = vs[16].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_1_a, coords_Z_1_b);
        xs[17] = vs[17].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_1_a, coords_Z_2_b);
        xs[18] = vs[18].v_coul0(d0_inter, m_k_x_inter_B_B_0, coords_B_2_a, coords_B_3_b);
        xs[19] = vs[19].v_coul0(d0_inter, m_k_x_inter_B_B_0, coords_B_2_a, coords_B_4_b);
        xs[20] = vs[20].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_2_a, coords_Z_1_b);
        xs[21] = vs[21].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_2_a, coords_Z_2_b);
        xs[22] = vs[22].v_exp0(d0_intra, m_k_x_intra_B_B_1, coords_B_3_b, coords_B_4_b);
        xs[23] = vs[23].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_3_b, coords_Z_1_a);
        xs[24] = vs[24].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_3_b, coords_Z_2_a);
        xs[25] = vs[25].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_4_b, coords_Z_1_a);
        xs[26] = vs[26].v_exp0(d0_inter, m_k_x_inter_B_Z_0, coords_B_4_b, coords_Z_2_a);
        xs[27] = vs[27].v_exp0(d0_inter, m_k_x_inter_Z_Z_0, coords_Z_1_a, coords_Z_1_b);
        xs[28] = vs[28].v_exp0(d0_inter, m_k_x_inter_Z_Z_0, coords_Z_1_a, coords_Z_2_b);
        xs[29] = vs[29].v_exp0(d0_inter, m_k_x_inter_Z_Z_0, coords_Z_2_a, coords_Z_1_b);
        xs[30] = vs[30].v_exp0(d0_inter, m_k_x_inter_Z_Z_0, coords_Z_2_a, coords_Z_2_b);

        double gsw12 = 0.0;
        double sw12 = f_switch(d12r, gsw12);

        sw = sw12;

        energies[j] = my_poly.eval(xs,coefficients.data(),gxs);
        energies_sw[j] = energies[j]*sw;

        for (size_t i = 0; i < 31; i++) {
            gxs[i] *= sw;
        }

        vs[0].grads(gxs[0], coords_A_1_a_g, coords_A_1_b_g, coords_A_1_a, coords_A_1_b);
        vs[1].grads(gxs[1], coords_A_1_a_g, coords_B_1_a_g, coords_A_1_a, coords_B_1_a);
        vs[2].grads(gxs[2], coords_A_1_a_g, coords_B_2_a_g, coords_A_1_a, coords_B_2_a);
        vs[3].grads(gxs[3], coords_A_1_a_g, coords_B_3_b_g, coords_A_1_a, coords_B_3_b);
        vs[4].grads(gxs[4], coords_A_1_a_g, coords_B_4_b_g, coords_A_1_a, coords_B_4_b);
        vs[5].grads(gxs[5], coords_A_1_a_g, coords_Z_1_b_g, coords_A_1_a, coords_Z_1_b);
        vs[6].grads(gxs[6], coords_A_1_a_g, coords_Z_2_b_g, coords_A_1_a, coords_Z_2_b);
        vs[7].grads(gxs[7], coords_A_1_b_g, coords_B_1_a_g, coords_A_1_b, coords_B_1_a);
        vs[8].grads(gxs[8], coords_A_1_b_g, coords_B_2_a_g, coords_A_1_b, coords_B_2_a);
        vs[9].grads(gxs[9], coords_A_1_b_g, coords_B_3_b_g, coords_A_1_b, coords_B_3_b);
        vs[10].grads(gxs[10], coords_A_1_b_g, coords_B_4_b_g, coords_A_1_b, coords_B_4_b);
        vs[11].grads(gxs[11], coords_A_1_b_g, coords_Z_1_a_g, coords_A_1_b, coords_Z_1_a);
        vs[12].grads(gxs[12], coords_A_1_b_g, coords_Z_2_a_g, coords_A_1_b, coords_Z_2_a);
        vs[13].grads(gxs[13], coords_B_1_a_g, coords_B_2_a_g, coords_B_1_a, coords_B_2_a);
        vs[14].grads(gxs[14], coords_B_1_a_g, coords_B_3_b_g, coords_B_1_a, coords_B_3_b);
        vs[15].grads(gxs[15], coords_B_1_a_g, coords_B_4_b_g, coords_B_1_a, coords_B_4_b);
        vs[16].grads(gxs[16], coords_B_1_a_g, coords_Z_1_b_g, coords_B_1_a, coords_Z_1_b);
        vs[17].grads(gxs[17], coords_B_1_a_g, coords_Z_2_b_g, coords_B_1_a, coords_Z_2_b);
        vs[18].grads(gxs[18], coords_B_2_a_g, coords_B_3_b_g, coords_B_2_a, coords_B_3_b);
        vs[19].grads(gxs[19], coords_B_2_a_g, coords_B_4_b_g, coords_B_2_a, coords_B_4_b);
        vs[20].grads(gxs[20], coords_B_2_a_g, coords_Z_1_b_g, coords_B_2_a, coords_Z_1_b);
        vs[21].grads(gxs[21], coords_B_2_a_g, coords_Z_2_b_g, coords_B_2_a, coords_Z_2_b);
        vs[22].grads(gxs[22], coords_B_3_b_g, coords_B_4_b_g, coords_B_3_b, coords_B_4_b);
        vs[23].grads(gxs[23], coords_B_3_b_g, coords_Z_1_a_g, coords_B_3_b, coords_Z_1_a);
        vs[24].grads(gxs[24], coords_B_3_b_g, coords_Z_2_a_g, coords_B_3_b, coords_Z_2_a);
        vs[25].grads(gxs[25], coords_B_4_b_g, coords_Z_1_a_g, coords_B_4_b, coords_Z_1_a);
        vs[26].grads(gxs[26], coords_B_4_b_g, coords_Z_2_a_g, coords_B_4_b, coords_Z_2_a);
        vs[27].grads(gxs[27], coords_Z_1_a_g, coords_Z_1_b_g, coords_Z_1_a, coords_Z_1_b);
        vs[28].grads(gxs[28], coords_Z_1_a_g, coords_Z_2_b_g, coords_Z_1_a, coords_Z_2_b);
        vs[29].grads(gxs[29], coords_Z_2_a_g, coords_Z_1_b_g, coords_Z_2_a, coords_Z_1_b);
        vs[30].grads(gxs[30], coords_Z_2_a_g, coords_Z_2_b_g, coords_Z_2_a, coords_Z_2_b);

        m1.grads(coords_Z_1_a_g, coords_Z_2_a_g, w12, wcross, coords_A_1_a_g);

        m2.grads(coords_Z_1_b_g, coords_Z_2_b_g, w12, wcross, coords_A_1_b_g);
        gsw12 *= (1.0)*energies[j]/d12r;


        for (size_t i = 0; i < 3; i++) {
            gradients[0 + i] += 0.0 + (gsw12*d12[i]);
            gradients[9 + i] += 0.0 - (gsw12*d12[i]);
        }


        for (size_t i = 0; i < 9; i++) {
            grad1[i + j*9] += gradients[0 + i];
        }


        for (size_t i = 0; i < 9; i++) {
            grad2[i + j*9] += gradients[9 + i];
        }

        
        if (virial != 0) {
        
            (*virial)[0] += -coords_A_1_a[0]*coords_A_1_a_g[0]
                        -coords_B_1_a[0]*coords_B_1_a_g[0]
                        -coords_B_2_a[0]*coords_B_2_a_g[0]
                        -coords_A_1_b[0]*coords_A_1_b_g[0]
                        -coords_B_3_b[0]*coords_B_3_b_g[0]
                        -coords_B_4_b[0]*coords_B_4_b_g[0];

        
            (*virial)[1] += -coords_A_1_a[0]*coords_A_1_a_g[1]
                        -coords_B_1_a[0]*coords_B_1_a_g[1]
                        -coords_B_2_a[0]*coords_B_2_a_g[1]
                        -coords_A_1_b[0]*coords_A_1_b_g[1]
                        -coords_B_3_b[0]*coords_B_3_b_g[1]
                        -coords_B_4_b[0]*coords_B_4_b_g[1];

        
            (*virial)[2] += -coords_A_1_a[0]*coords_A_1_a_g[2]
                        -coords_B_1_a[0]*coords_B_1_a_g[2]
                        -coords_B_2_a[0]*coords_B_2_a_g[2]
                        -coords_A_1_b[0]*coords_A_1_b_g[2]
                        -coords_B_3_b[0]*coords_B_3_b_g[2]
                        -coords_B_4_b[0]*coords_B_4_b_g[2];

        
            (*virial)[4] += -coords_A_1_a[1]*coords_A_1_a_g[1]
                        -coords_B_1_a[1]*coords_B_1_a_g[1]
                        -coords_B_2_a[1]*coords_B_2_a_g[1]
                        -coords_A_1_b[1]*coords_A_1_b_g[1]
                        -coords_B_3_b[1]*coords_B_3_b_g[1]
                        -coords_B_4_b[1]*coords_B_4_b_g[1];

        
            (*virial)[5] += -coords_A_1_a[1]*coords_A_1_a_g[2]
                        -coords_B_1_a[1]*coords_B_1_a_g[2]
                        -coords_B_2_a[1]*coords_B_2_a_g[2]
                        -coords_A_1_b[1]*coords_A_1_b_g[2]
                        -coords_B_3_b[1]*coords_B_3_b_g[2]
                        -coords_B_4_b[1]*coords_B_4_b_g[2];

        
            (*virial)[8] += -coords_A_1_a[2]*coords_A_1_a_g[2]
                        -coords_B_1_a[2]*coords_B_1_a_g[2]
                        -coords_B_2_a[2]*coords_B_2_a_g[2]
                        -coords_A_1_b[2]*coords_A_1_b_g[2]
                        -coords_B_3_b[2]*coords_B_3_b_g[2]
                        -coords_B_4_b[2]*coords_B_4_b_g[2];

            (*virial)[3] = (*virial)[1];
            (*virial)[6] = (*virial)[2];
            (*virial)[7] = (*virial)[5];


        }


    }

    double energy = 0.0;
    for (size_t i = 0; i < n; i++)
        energy += energies_sw[i];

    return energy;

}

//----------------------------------------------------------------------------//
} // namespace mbnrg_A1B2Z2_A1B2Z2_deg4
